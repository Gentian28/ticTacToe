!function(e){var t={};function n(l){if(t[l])return t[l].exports;var r=t[l]={i:l,l:!1,exports:{}};return e[l].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,l){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:l})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var l=Object.create(null);if(n.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(l,r,function(t){return e[t]}.bind(null,r));return l},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);class l{constructor(){this.playerOneTemplate='\n        <div class="x-symbol">\n            <div class="left"></div>\n            <div class="right"></div>\n        </div>\n        ',this.playerTwoTemplate='\n        <svg class="circle-symbol" width="50px" height="50px">\n            <circle class="path" stroke="#F2EBD3" stroke-width="6" stroke-miterlimit="10" cx="25" cy="25" r="22"\n                stroke="#F2EBD3" fill="transparent" />\n        </svg>\n        ',this.drawTemplate='\n        <div id="draw-template">\n            <div class="x-symbol">\n                <div class="left"></div>\n                <div class="right"></div>\n            </div>\n            <svg class="circle-symbol" width="50px" height="50px">\n                <circle class="path" stroke="#F2EBD3" stroke-width="6" stroke-miterlimit="10" cx="25" cy="25" r="22"\n                    stroke="#F2EBD3" fill="transparent" />\n            </svg>\n        </div>\n        '}renderResult(e,t){return`\n        <div id="result">\n            ${e}\n            <div>${t}!</div>\n            <button type="button" id="restartGame" class="waves-effect waves-light btn">Start new game</button>\n        </div>`}}class r{constructor(e,t){this.gameId=e,this.players=t,this.resultTemplate=new l,this.moves=[null,null,null,null,null,null,null,null,null],this.turn=0}generateTicTacToe(){const e=document.createElement("tbody");for(let t=0;t<3;t++){const t=document.createElement("tr");for(let e=0;e<3;e++){const e=document.createElement("td");t.appendChild(e)}e.appendChild(t)}return e}newGame(){ticTacToeField.appendChild(this.generateTicTacToe())}checkWinner(e,t){let n=!1;("X"===t[0]&&"X"===t[1]&&"X"===t[2]||"X"===t[3]&&"X"===t[4]&&"X"===t[5]||"X"===t[6]&&"X"===t[7]&&"X"===t[8]||"X"===t[0]&&"X"===t[3]&&"X"===t[6]||"X"===t[1]&&"X"===t[4]&&"X"===t[7]||"X"===t[2]&&"X"===t[5]&&"X"===t[8]||"X"===t[0]&&"X"===t[4]&&"X"===t[8]||"X"===t[2]&&"X"===t[4]&&"X"===t[6]||"O"===t[0]&&"O"===t[1]&&"O"===t[2]||"O"===t[3]&&"O"===t[4]&&"O"===t[5]||"O"===t[6]&&"O"===t[7]&&"O"===t[8]||"O"===t[0]&&"O"===t[3]&&"O"===t[6]||"O"===t[1]&&"O"===t[4]&&"O"===t[7]||"O"===t[2]&&"O"===t[5]&&"O"===t[8]||"O"===t[0]&&"O"===t[4]&&"O"===t[8]||"O"===t[2]&&"O"===t[4]&&"O"===t[6])&&(message.innerHTML=e?this.resultTemplate.renderResult(this.resultTemplate.playerTwoTemplate,"winner"):this.resultTemplate.renderResult(this.resultTemplate.playerOneTemplate,"winner"),n=!0,ticTacToeField.style.transform="scale(0)",restartGame.addEventListener("click",this.triggerReset)),t.includes(null)||n||(message.innerHTML=this.resultTemplate.renderResult(this.resultTemplate.drawTemplate,"draw"),ticTacToeField.style.transform="scale(0)",restartGame.addEventListener("click",this.triggerReset))}triggerReset(){reset.click()}reset(){this.moves=[null,null,null,null,null,null,null,null,null],this.turn=0,message.innerHTML="",ticTacToeField.style.transform="scale(1)"}}const o=io.connect("https://tictactoews.herokuapp.com:443/");o.on("connect",()=>{loading.style.display="none",console.log("connected")});const i=new l;let a=[];o.on("connected players",e=>{null===localStorage.getItem("uuid")&&localStorage.setItem("uuid",([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16))),connectedPlayers.innerHTML=e}),createRoom.onclick=()=>{-1===a.map(e=>e.gameId).indexOf(localStorage.getItem("uuid"))?o.emit("generate room",localStorage.getItem("uuid")):console.log("You have already created a game")},o.on("games",e=>{a=e,roomsList.innerHTML=e.length?'<li class="collection-header"><h5>Rooms List</h5></li>':'<li class="collection-header"><h6>No rooms, click the button above to generate a new one</h6></li>',e.forEach(e=>{const t=document.createElement("li"),n=document.createElement("button"),l=document.createTextNode("Game generated by "+e.gameId);n.setAttribute("class","collection-item"),n.setAttribute("id",e.gameId),e.players.length>=2&&n.setAttribute("disabled",!0),t.appendChild(n),n.appendChild(l),roomsList.append(t)})}),o.on("player disconnected",(function(e){connectedPlayers.innerHTML=e}));let s,c,d,m="";o.on("room joined",e=>{if(console.log(e),e.gameId===m&&(roomOnlinePlayers.innerHTML=e.players.length<2?"Waiting opponent":"",e.players.length>=2&&(s=new r(m,[e.players[0],e.players[1]]),d=localStorage.getItem("uuid")===e.players[0]?0:1,s.newGame(),c=document.querySelectorAll("#ticTacToeField td"),c.forEach((e,t)=>{e.onclick=()=>{e.hasChildNodes()||(s.turn===d?o.emit("move",{index:t,gameId:m}):console.log("You cant play"))}}))),e.players.length>=2){document.getElementById(e.gameId).setAttribute("disabled",!0)}}),roomsList.onclick=e=>{if("BUTTON"===e.target.tagName){ticTacToeField.innerHTML="",m=e.target.id;const t=e.target.id,n=localStorage.getItem("uuid");o.emit("join room",{gameId:t,playerId:n}),rooms.style.display="none",game.setAttribute("class",t),document.getElementsByClassName(t)[0].style.display="block",gameIdContainer.innerHTML=t}},exitGame.onclick=()=>{console.log("clicked"),o.emit("exit room",{gameId:m})},o.on("reset",(function(e){e===m&&(c.forEach(e=>{e.innerHTML=""}),s.reset())})),o.on("move made",(function(e){e.gameId===m&&(0===s.turn?(c[e.index].innerHTML=i.playerOneTemplate,s.moves[e.index]="X"):(c[e.index].innerHTML=i.playerTwoTemplate,s.moves[e.index]="O"),s.checkWinner(s.turn,s.moves),s.turn?s.turn=0:s.turn=1)})),reset.onclick=()=>{o.emit("reset",m)},o.on("room exited",e=>{if(e.gameId===m){roomOnlinePlayers.innerHTML=`Opononet left the game, online players: ${e.players.length}`;const t=document.getElementById("game");rooms.style.display="block",t.removeAttribute("class"),t.style.display="none",reset.click()}document.getElementById(e.gameId).removeAttribute("disabled")}),o.on("disconnected socket",e=>{})}]);